[gcode_macro disable_timeout]
variable_enabled: 0
gcode:
  {% set state = params.BLOCK|default(1)|int %}
  SET_GCODE_VARIABLE MACRO=disable_timeout VARIABLE=enabled VALUE={state}
  RESPOND PREFIX="" MSG="Idle timeout is disabled. Make sure to enabled it using ENABLE_TIMEOUT or by restarting klipper."

[gcode_macro enable_timeout]
gcode:
  SET_GCODE_VARIABLE MACRO=disable_timeout VARIABLE=enabled VALUE=0
  RESPOND PREFIX="" MSG="Idle timeout is enabled."
